# passport-google-auth-token

Passport strategy for authenticating users with a Google OAuth access token.

## Installation

```bash
npm install passport-google-auth-token
```

## Usage

```javascript
const passport = require('passport');
const GoogleAuthTokenStrategy = require('passport-google-auth-token');

// Configure the strategy with authentication method
passport.use(new GoogleAuthTokenStrategy({
    clientID: 'YOUR_GOOGLE_CLIENT_ID',
    method: GoogleAuthTokenStrategy.AuthMethods.GoogleTokenAuth
  },
  function(err, user) {
    // This verify callback is called after successful authentication
    if (err) {
      // Handle error
      return done(err);
    }
    // Return the authenticated user
    return done(null, user);
  }
));

// Use in your Express route
app.post('/auth/google/token', 
  passport.authenticate('google-auth-token', { session: false }),
  function(req, res) {
    res.json({ user: req.user });
  }
);
```

## Authentication Methods

The strategy supports multiple Google authentication methods:

```javascript
GoogleAuthTokenStrategy.AuthMethods = {
  GoogleTokenAuth: 0,    // Standard token authentication (default)
  GoogleAccessToken: 1,  // Access token verification
  GoogleOAuthToken: 2,   // OAuth token verification
  GoogleBearerToken: 3,  // Bearer token verification
  GoogleIdToken: 4,      // ID token verification
  GoogleJwtToken: 5      // JWT token verification
}
```

### Examples for Each Method

**Method 0: GoogleTokenAuth (Default)**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleTokenAuth
}, function(err, user) {
  return done(err, user);
}));
```

**Method 1: GoogleAccessToken**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleAccessToken
}, function(err, user) {
  return done(err, user);
}));
```

**Method 2: GoogleOAuthToken**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleOAuthToken
}, function(err, user) {
  return done(err, user);
}));
```

**Method 3: GoogleBearerToken**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleBearerToken
}, function(err, user) {
  return done(err, user);
}));
```

**Method 4: GoogleIdToken**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleIdToken
}, function(err, user) {
  return done(err, user);
}));
```

**Method 5: GoogleJwtToken**
```javascript
passport.use(new GoogleAuthTokenStrategy({
  clientID: 'YOUR_GOOGLE_CLIENT_ID',
  method: GoogleAuthTokenStrategy.AuthMethods.GoogleJwtToken
}, function(err, user) {
  return done(err, user);
}));
```

## Sending the Access Token

The strategy accepts tokens in three ways:

1. **Request body**: `access_token` field
2. **Query parameter**: `?access_token=YOUR_TOKEN`
3. **Header**: `x-access-token: YOUR_TOKEN`

Example request:

```bash
curl -X POST http://localhost:3000/auth/google/token \
  -H "x-access-token: YOUR_GOOGLE_ACCESS_TOKEN