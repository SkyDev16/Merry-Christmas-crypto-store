const passport = require('passport');
const GoogleAuthTokenStrategy = require('./index');

// Initialize passport
passport.initialize();

// Configure the strategy
passport.use(new GoogleAuthTokenStrategy(
  {
    method: GoogleAuthTokenStrategy.AuthMethods.GoogleTokenAuth
  },
  function(err, user) {
    if (err) {
      console.error('Authentication error:', err);
      return;
    }
    console.log('Authentication successful!');
    console.log('User:', user);
  }
));

// Mock request object
const mockRequest = {
  body: {
    access_token: 'test-token-123'
  },
  query: {},
  headers: {}
};

// Test the authentication
console.log('Testing Google Auth Token Strategy...');
console.log('Method:', GoogleAuthTokenStrategy.AuthMethods.GoogleTokenAuth);

const strategy = passport._strategy('google-auth-token');
if (strategy) {
  strategy.authenticate({});
} else {
  console.error('Strategy not found');
}
